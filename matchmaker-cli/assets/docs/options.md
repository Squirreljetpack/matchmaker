# Configuration Reference

Matchmaker allows you to override any configuration setting directly from the command line. Overrides are specified as key-value pairs following the standard arguments.

## Syntax

Overrides follow the pattern `path=value` or `path value`.

- **Hierarchical Paths**: Use dot notation to navigate the configuration structure (e.g., `results.fg`).
- **Flattened Fields**: Several major configuration blocks are "flattened," meaning their children can be accessed as top-level keys.
- **Shortcuts**: Many common paths have short aliases:
  - `b` -> `binds`
  - `p` -> `preview`
  - `h` -> `header`
  - `r.r` -> `results.reverse`
  - `r.w` -> `results.wrap`
  - `p.l.x` -> `preview.layout.command`
  - `m.x` -> `matcher.command`
  - `m.i` -> `matcher.input_separator`

### Collections (Lists/Vectors)

Fields that are collections (like `preview.layout` or `binds`) are treated as **additive leaf nodes**.

1. **Adding Elements**: Each time a collection path is specified, a new partial element is added to that collection.
2. **Merging**: When the configuration is finalized:
   - The first $N$ overrides for a collection are merged into the first $N$ elements of the base configuration (from your config file). (Or in the case of of binds, existing keys are overridden).
   - Any additional overrides are appended as new elements.

### Leaf values

If a "leaf" value contains multiple settings (like a [border](#border) or a bind with multiple actions), you can specify them within a single string using `key=value` pairs or nested dot notation.

```bash
# Example: 
# If you started with one preview layout, the following overrides the first preview layout, and adds two new ones. It also sets 3 binds.
mm p.l command=hi p.l "x=bye min=3" b "ctrl-c=Quit ?=preview[echo hi]" b.ctrl-a "cancel"

# Example: 
# Setting the column splitting delimiter
mm m.c.s "Delimiter \t" # matcher.columns.split = Split::Delimiter(Regex('\t'))
```

## Available Options

### Matcher (`matcher.`)

- `normalize`: (bool) Enable/disable normalization of characters (e.g., matching 'e' with 'Ã©').
- `ignore_case`: (bool) Enable/disable case-insensitive matching.
- `prefer_prefix`: (bool) Prioritize matches that start with the query.
- `c`, `command`: (string) The shell command used to generate items. Alias: `x`.
- `i`, `input_separator`: (char) Character separating input items.
- `o`, `output_separator`: (string) String separating output selections.
- `s`, `sync`: (bool) Whether to wait for the command to finish before starting.

#### Worker *(flattened)*

- `trim`: (bool) Trim whitespace from input lines.
- `sort_threshold`: (u32) Number of items above which sorting is disabled for performance.
- `c`, `columns`: Column parsing configuration.
  - `s`, `d`, `split`: How columns are split. Can be `None`, `Delimiter <regex>`, or `Regexes [<regex>, ...]`.
  - `names`, `n`: List of column names/settings.
    - `name`: (string) Name of the column.
    - `filter`: (bool) Whether this column is searchable (default: true).
    - `hidden`: (bool) Whether this column is hidden from display.
  - `max_columns`: (usize) Maximum number of autogenerated columns.

#### Exit Conditions *(flattened)*

- `select_1`: (bool) Exit automatically if there is only one match.
- `allow_empty`: (bool) Allow returning without any items selected.
- `abort_empty`: (bool) Abort if no items are provided.

### UI & Rendering

#### Global UI (`ui.`)

- `tick_rate`: (u8) Refresh rate of the UI (default 60).
- `border`: [Border Settings](#border-settings).

#### Input Bar (`input.`)

- `prompt`: (string) The prompt string (default "> ").
- `initial`: (string) Initial text in the input bar.
- `fg`: (color) Foreground color of the input text.
- `modifier`: (modifier) Style modifier for the input text.
- `prompt_fg`: (color) Foreground color of the prompt.
- `prompt_modifier`: (modifier) Style modifier for the prompt.
- `cursor`: `None` or `Default`.
- `border`: [Border Settings](#border-settings).

#### Results Table (`results.`, `r`)

- `multi_prefix`: (string) Prefix for multi-selected items.
- `default_prefix`: (string) Prefix for normal items.
- `current_prefix`: (string) Prefix for the currently highlighted item.
- `fg`: (color) Default foreground color.
- `modifier`: (modifier) Default style modifier.
- `match_fg`: (color) Foreground color for matching characters.
- `match_modifier`: (modifier) Style for matching characters.
- `current_fg`: (color) Foreground color of the highlighted item.
- `current_bg`: (color) Background color of the highlighted item.
- `current_modifier`: (modifier) Style of the highlighted item.
- `row_connection_style`: `Disjoint`, `Capped`, or `Full`. Controls how current item styles apply across the row.
- `status_fg`: (color) Color of the status line.
- `status_modifier`: (modifier) Style of the status line.
- `status_show`: (bool) Show/hide the status line.
- `scroll_wrap`: (bool) Wrap selection when reaching the end of the list.
- `scroll_padding`: (u16) Number of items to keep visible above/below the selection.
- `r`, `reverse`: (When) When to reverse the list order (`Always`, `Never`, `Auto`).
- `w`, `wrap`: (bool) Enable line wrapping for result items.
- `wrap_scaling_min_width`: (u16) Minimum width for wrapping.
- `column_spacing`: (u16) Spacing between columns.
- `right_align_last`: (bool) Right-align the last column.
- `border`: [Border Settings](#border-settings).

#### Preview Panel (`preview.`, alias: `p`)

- `show`: (bool) Toggle the preview window.
- `scroll_wrap`: (bool) Enable scroll wrapping in preview.
- `wrap`: (bool) Enable line wrapping in preview.
- `l`, `layout`: List of preview settings.
  - `x`, `cmd`, `command`: Command to run for preview. `{}` is replaced by the item.
  - `layout` *(flattened)*:
    - `side`: `top`, `bottom`, `left`, `right`.
    - `percentage`: Percentage of the screen to occupy.
    - `min`, `max`: Pixel constraints for the preview size.
- `border`: [Border Settings](#border-settings).

#### Header & Footer (`header.`, `footer.`, alias: `h` for header)

- `content`: (string or list) Static content to display. Set to `auto` for default behavior.
- `fg`, `modifier`: Style of the text.
- `match_indent`: (bool) Indent content to match the results table.
- `wrap`: (bool) Enable line wrapping.
- `row_connection_style`: See Results Table.
- `l`, `lines`, `header_lines`: (usize, header only) Number of lines to read from input for the header.
- `border`: [Border Settings](#border-settings).

### TUI Settings (`tui.`)

- `restore_fullscreen`: (bool) Restore fullscreen on exit.
- `redraw_on_resize`: (bool) Redraw the UI when the terminal is resized.
- `extended_keys`: (bool) Enable enhanced keyboard support.
- `sleep_ms`: (u32) Delay in milliseconds before resizing.
- `clear_on_exit`: (bool) Clear the TUI screen after selection.
- `layout` *(flattened)*: Constraints for non-fullscreen mode.
  - `percentage`: Height of the terminal used.
  - `min`, `max`: Pixel constraints.

### Border Settings

Most UI components have a `border` block:

- `type`: `Plain`, `Rounded`, `Double`, `Thick`, `Sextant`, etc.
- `color`: CSS-style colors or named colors (e.g., `blue`, `red`, `#ff0000`).
- `bg`: Background color of the bordered area.
- `sides`: Which sides to show (e.g., `TOP | BOTTOM | LEFT | RIGHT`). Empty string for none.
- `padding`: Padding inside the border. Can be 1 value (all), 2 (vertical, horizontal), or 4 (top, right, bottom, left).
- `title`: Optional text to display on the border.
- `title_modifier`: Style modifier for the title.

### Key Binds (`binds.`, alias: `b`)

Map keys or mouse events to actions.

- `key=Action`: e.g., `ctrl-c=Quit`.
- `key=[Action1, Action2]`: Sequence of actions.

#### Triggers

- **Keyboard**: Standard key names (`enter`, `esc`, `up`, `down`, `left`, `right`, `tab`, `backspace`, etc.) and combinations (`ctrl-a`, `alt-enter`, `shift-up`).
- **Mouse**: `left`, `middle`, `right`, `scrollup`, `scrolldown`, `scrollleft`, `scrollright`. Modifiers can be added: `ctrl+left`, `alt+scrollup`.

#### Actions

- **Selection**: `Select`, `Deselect`, `Toggle`, `CycleAll`, `ClearSelections`, `Accept`, `Quit(code)`.
- **Navigation**: `Up(n)`, `Down(n)`, `Pos(pos)`, `ForwardChar`, `BackwardChar`, `ForwardWord`, `BackwardWord`, `InputPos(pos)`.
- **Preview**: `CyclePreview`, `Preview(cmd)`, `Help(section)`, `SetPreview(idx)`, `SwitchPreview(idx)`, `PreviewUp(n)`, `PreviewDown(n)`, `PreviewHalfPageUp`, `PreviewHalfPageDown`, `ToggleWrapPreview`.
- **Input/Edit**: `SetInput(str)`, `Cancel` (clear input), `DeleteChar`, `DeleteWord`, `DeleteLineStart`, `DeleteLineEnd`, `HistoryUp`, `HistoryDown`, `ToggleWrap`.
- **UI/Display**: `SetHeader(str)`, `SetFooter(str)`, `SetPrompt(str)`, `Column(idx)`, `CycleColumn`, `Redraw`, `Overlay(idx)`.
- **System**: `Execute(cmd)`, `Become(cmd)` (replace matchmaker with command), `Reload(cmd)`, `Print(str)`.
